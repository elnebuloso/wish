#!/bin/bash

##########################################################################################################

set -e

##########################################################################################################

: "${WISH_VERBOSE_LEVEL:=0}"

##########################################################################################################

if [[ ${WISH_VERBOSE_LEVEL} -gt 0 ]]; then
    clear
fi

##########################################################################################################

declare -a ARGS

while [[ "$#" -gt 0 ]]
do
  case $1 in
    --env)
      export $2
      shift
      ;;
    *)
      ARGS+=("${1}")
  esac
  shift
done

CMD=${ARGS[@]:0:1}
ARG=${ARGS[@]:1}

##########################################################################################################

if [[ -f "/usr/local/bin/wish.${CMD}" ]]; then
    /usr/local/bin/wish.${CMD} ${ARG}
    exit 0;
fi

##########################################################################################################

if [[ "$CMD" =~ ^--* ]]; then
    CMD="wish ${CMD}"
fi

if [[ -z "${CMD}" ]]; then
    CMD="wish --version"
fi

COMMAND="${CMD} ${ARG}"

##########################################################################################################

${COMMAND}

##########################################################################################################